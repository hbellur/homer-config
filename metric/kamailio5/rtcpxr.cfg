
route[RTCPXR] {
	if (is_method("PUBLISH")) {
		if ($cT == "application/vq-rtcpxr" && $(rb{s.substr,0,1}) != "x") {

		$var(host) = $HN(n);
		$var(influxdbHost) = "host=" + $var(host);

		$var(isoTime)      = $timef(%Y-%m-%dT%H:%M:%S);
		$var(unixTimeGen)  = $TS - 60;
		$var(unixTimeMic)  = $TV(u);
		$var(unixTimeMil)  = $var(unixTimeMic)/1000;
		$var(elasticTime)  = $_s($var(isoTime).$var(unixTimeMil)Z);
		$var(graylogTime)  = $_s($var(unixTimeGen).$var(unixTimeMil));
		$var(influxdbTime) = $_s($var(unixTimeGen)$var(unixTimeMic));

		$var(stats_elastic)  = "";
		$var(stats_influxdb) = "";
		$var(type)   = "stats_rtcpxr";
		$var(XRHEAD) = $rb;

		$var(lpt)  = 0;
		$var(lsr)  = 0;
		$var(lfd)  = 0;
		$var(lfo)  = 0;
		$var(lpps) = 0;
		$var(lplc) = 0;

		$var(ljba) = 0;
		$var(ljbr) = 0;
		$var(ljbn) = 0;
		$var(ljbm) = 0;
		$var(ljbx) = 0;

		$var(lnlr) = "";
		$var(ljdr) = "";
		
		$var(lbld)  = "";
		$var(lbd)   = "";
		$var(lgld)  = "";
		$var(lgd)   = 0;
		$var(lgmin) = 0;
		
		$var(lrtd)  = 0;
		$var(lesd)  = 0;
		$var(lsowd) = 0;
		$var(liaj)  = 0;
		$var(lmaj)  = 0;
		
		$var(lsl)   = 0;
		$var(lnl)   = 0;
		$var(lrerl) = 0;
		
		$var(lrlq)   = 0;
		$var(lrcq)   = 0;
		$var(lextri) = 0;
		$var(lmoslq) = "";
		$var(lmoscq) = "";
		

		$var(callid) = $(var(XRHEAD){re.subst,/.*CallID:\s*([0-9A-Za-z@_\.\-]{5,120}).*$/\1/s});
		if ($var(XRHEAD) =~ ".*PT=[0-9]") $var(lpt)  = $(var(XRHEAD){re.subst,/.*PT=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*SR=[0-9]") $var(lsr)  = $(var(XRHEAD){re.subst,/.*SR=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*FD=[0-9]") $var(lfd)  = $(var(XRHEAD){re.subst,/.*FD=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*FO=[0-9]") $var(lfo)  = $(var(XRHEAD){re.subst,/.*FO=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*PPS=[0-9]") $var(lpps) = $(var(XRHEAD){re.subst,/.*PPS=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*PLC=[0-9]") $var(lplc) = $(var(XRHEAD){re.subst,/.*PLC=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*JBA=[0-9]") $var(ljba) = $(var(XRHEAD){re.subst,/.*JBA=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*JBR=[0-9]") $var(ljbr) = $(var(XRHEAD){re.subst,/.*JBR=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*JBN=[0-9]") $var(ljbn) = $(var(XRHEAD){re.subst,/.*JBN=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*JBM=[0-9]") $var(ljbm) = $(var(XRHEAD){re.subst,/.*JBM=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*JBX=[0-9]") $var(ljbx) = $(var(XRHEAD){re.subst,/.*JBX=([0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*NLR=[0-9]") $var(lnlr) = $(var(XRHEAD){re.subst,/.*NLR=([0-9]+\.[0-9]+).*$/\1/s});
		if ($var(XRHEAD) =~ ".*JDR=[0-9]") $var(ljdr) = $(var(XRHEAD){re.subst,/.*JDR=([0-9]+\.[0-9]+).*$/\1/s});

			
		report_capture("report_capture", "$var(callid)");
		
		}
	}
}